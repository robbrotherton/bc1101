---
format: 
  revealjs:
    chalkboard: true
---

# 8|SAMPLING

![](media/08_sampling-animated.gif){.invertable}

```{r data}
library(bc1101tools)
library(dplyr)

stick_heights <- c(60, 62, 64, 66)

sampling_dist_df <- expand.grid(stick_heights, stick_heights) |> 
  rowwise() |>
  mutate(M = mean(c(Var1, Var2))) |> 
  ungroup() |> 
  mutate(Sample = row_number()) |> 
  select(Sample, X1 = Var1, X2 = Var2, M)
```

```{r figures}
#| eval: false

library(ggplot2)

plot_histogram(stick_heights, xlab = "Height (inches)") +
  scale_x_continuous(breaks = 60:66) +
  scale_y_continuous(breaks = 0:1, expand = expansion(c(0, .05))) +
  theme_bc1101()

ggsave(here::here("slides", "media", "stick-histogram.svg"),
       width = 6, height = 1.3)

plot_histogram(sampling_dist_df$M, xlab = "Sample Means", block = TRUE) +
  scale_x_continuous(breaks = 60:66) +
  theme_bc1101()

ggsave(here::here("slides", "media", "stick-sampling-distribution.svg"),
       width = 6, height = 4)

```


# Overview

- [Sampling error]
- [Distribution of sample means]
- [Central Limit Theorem]
- [Learning checks]


## Roadmap

- So far...  
  - $z$-scores describe the location of a single score in a sample or in a population
  - Normal distributions: precisely quantify probability of obtaining certain *scores*
- Moving forward...


# Sampling error

- Sampling Error
  - Discrepancy between a sample statistic and the population parameter

![](media/pop-sample-ani.gif)

## Sampling error

- Discrepancy between a sample statistic and the population parameter
  - E.g. Opinion polling
  - see [Pew explainer](https://www.pewresearch.org/fact-tank/2016/09/08/understanding-the-margin-of-error-in-election-polls/)

![](media/margin-of-error.png)


## Sampling error


## Sampling error

:::: {.center-element .invertable .r-stack}

<video start="0" src="media/iq-sampling.mp4"></video>

::: {.fragment}
<video controls start="0" src="media/iq-sampling.mp4"></video>
:::

::::

```{r}
#| eval: true

set.seed(40)
n <- 200
iq_samples <- replicate(n, rnorm(10, mean = 100, sd = 15) |> round(0), simplify = FALSE)
iq_means <- lapply(iq_samples, mean)

cat("Sample 1:", iq_samples[[1]], "   Mean =", iq_means[[1]])
cat("Sample 2:", iq_samples[[2]], "   Mean =", iq_means[[2]])
cat("Sample 3:", iq_samples[[3]], "   Mean =", iq_means[[3]])
```


# Distribution of Sample Means

- "Distribution of Sample Means" / "Sampling distribution of the mean"
  - Distribution of sample means obtained by selecting all possible samples of size $n$ from a population
  - Often huge number of possible samples
  - But distribution forms a simple & predictable pattern

## Characteristics {.smaller}
  - Shape
      - The distribution will be approximately normal
      - Sample $M$s are representative of population $\mu$
      - Most means will be close to $\mu$; means far from $\mu$ are rare
  - Center
      - The center/average of the distribution will be close to $\mu$
      - $M$ is a *unbiased* statistic
      - *On average*, $M = \mu$
  - Variability
      - Related to sample size, $n$
      - The larger the sample, the less the variability 
      - Larger samples are more representative


## Example: height distribution

![](media/stickpeople.svg)

![](media/stick-histogram.svg)

## Example: height distribution of the mean

:::: {.columns}

::: {.column width="30%"}
![](media/stick-histogram.svg)

```{r stick-table}
#| style: "font-size: 0.5em;line-height: 0.9em;"

knitr::kable(sampling_dist_df)
  
```

:::

::: {.column width="70%"}
Sampling distribution ($n = 2$)

![](media/stick-sampling-distribution.svg)

::: {.center-element .small}
$p(M < 61) =\ ?$

$p(62 \le M \le 64) =\ ?$

$p(M > 65) =\ ?$
:::

:::

::::


# Central Limit Theorem

- Sampling & the Central Limit Theorem
  - Distribution of samples means based on all possible samples from a population not feasible in most realistic situations
  - But we can [mathematically predict]{.emph} shape, mean, & variability for any sample size & population

## Central Limit Theorem

- For any population with mean $\mu$ and standard deviation $\sigma$, the distribution of sample means for sample size n will have…
  - An expected mean $\mu_M$ of $\mu$ 
  - A standard deviation of $\dfrac{\sigma} {\sqrt{n}}$ 
  - And will approach a normal distribution as $n$ approaches infinity


## Shape {.small}

- Almost perfectly normal in either of two conditions 
  - The population from which the samples are selected is a normal distribution
  - Or…
  - Sample $n$s are relatively large

::: {.fragment}
- ...what is *relatively large*? 
  - As $n$ approaches infinity, distribution of sample means approaches a normal distribution 
  - But by $n = 30$ means pile up symmetrically around $\mu$
  - Population distribution does not need to be normal; can be skewed, flat, bimodal, whatever
:::

## Mean

- Mean of the distribution of sample means is called the [expected value of $M$ ( $\mu_M$ )]{.emph} 
  - On average, $M = \mu_M  = \mu$
  - $M$ is [unbiased]{.emph}
  - If we only have a single sample $M$, our best guess at the (unknown) population mean should always be the (known) sample mean
  - But we can acknowledge variability...

## Variability

- Standard deviation of the sample means
  - ["Standard error of the mean";  $\sigma_M$]{.emph}
  - Measure of how well a sample mean estimates its population mean
  - How much sampling error we can expect; how much distance is expected on average between $M$ and $\mu$

::: {.center-element}
$\sigma_M = \dfrac{\sigma}{\sqrt{n}}$ or $\dfrac{\sqrt{\sigma^2}}{\sqrt{n}}$ or $\sqrt{\dfrac{\sigma^2}{n}}$
:::

## Variability

![](media/samp-dist-1.png)

## Variability

![](media/samp-dist-2.png)


## Variability: heights sampling dist

:::: {.columns}

::: {.column width="30%"}
![](media/stick-histogram.svg)

```{r}
#| style: "font-size: 0.5em; line-height: 0.9em;"

knitr::kable(sampling_dist_df)
  
```

:::

::: {.column width="70%"}
Sampling distribution ($n = 2$)

![](media/stick-sampling-distribution.svg)

::: {.center-element .small}
$\sigma_M = \dfrac{\sigma}{\sqrt{n}} = \dfrac{2.24}{\sqrt{2}} = 1.58$
:::

:::

::::

## Summary

- Summary
  - Distribution of sample means for samples of size $n$ will have...
    - a mean of $\mu_M$
    - standard deviation $\sigma_M = \sigma / \sqrt{n}$
    - Shape will be normal if population is normally distributed, or $n > 30$

# Learning checks {.small}

1. True or False?
  - The mean of a sample is always equal to the population mean
  - The shape of a distribution of sample means is always normal
  - As sample size increases, the value of the standard error always decreases
2. Describe the distribution of sample means (shape, expected value of the mean, and standard error) for samples of $n = 100$ selected from a population with $\mu = 40$ and $\sigma = 10$.
